% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cell_distance.R
\name{calculateSNR}
\alias{calculateSNR}
\title{Calculate the Signal-to-Noise Ratio (SNR) for gene filtering}
\usage{
calculateSNR(
  x,
  assay = "logcounts",
  assay.sd = "logcounts_sd",
  gene_mu = "sanity_log_activity_mean",
  mu_sd = "sanity_log_activity_mean_sd",
  subset.row = NULL
)
}
\arguments{
\item{x}{A \linkS4class{SingleCellExperiment} or
\linkS4class{SummarizedExperiment} object with Sanity results.}

\item{assay}{The name of the assay containing the log-normalized counts matrix.}

\item{assay.sd}{The name of the assay containing the standard deviation of
the log-normalized counts.}

\item{gene_mu}{The name of the column in \code{rowData(x)} containing the mean
log activity of the genes.}

\item{mu_sd}{The name of the column in \code{rowData(x)} containing the standard
deviation of the mean log activity of the genes.}

\item{subset.row}{A vector of row indices or logical vector indicating which
rows to use.}
}
\value{
A named numeric vector of SNR values, one per gene (or per row in
\code{subset.row}).
}
\description{
Computes the signal-to-noise ratio (SNR) for each gene as the ratio of the
variance of log-normalized counts across cells to the mean measurement noise
variance. This can be used to filter highly variable genes before downstream
analysis.
}
\details{
The SNR for gene \eqn{g} is defined as:
\deqn{SNR_g = \frac{Var_c(\delta_{gc})}{Mean_c(\epsilon_{gc}^2)}}

where \eqn{\delta_{gc}} are the cell-specific log fold-changes and
\eqn{\epsilon_{gc}^2} is the cell-specific measurement noise variance.
Both are derived from the Sanity output assays.

A high SNR indicates that a gene's expression varies substantially across
cells relative to measurement noise, making it informative for downstream
analyses. The same SNR is used internally by \code{\link[=calculateSanityDistance]{calculateSanityDistance()}} to
exclude uninformative genes via \code{snr_cutoff}.

Note that because both expression estimates and error bars vary across cells,
an SNR-based filter may not be optimal in all situations. For example, a
marker gene expressed only in a rare cell type may have low overall SNR
despite being highly informative.
}
\examples{
sce <- simulate_branched_random_walk(N_gene=500, N_path=10, length_path=10)
sce <- Sanity(sce)
snr <- calculateSNR(sce)
hist(log10(snr), breaks=30, main="Gene SNR distribution")

# Filter genes with SNR > 1 before computing distances
d <- calculateSanityDistance(sce, subset.row=which(snr > 1))

}
\seealso{
\code{\link[=calculateSanityDistance]{calculateSanityDistance()}} which uses SNR internally to filter genes.
}
